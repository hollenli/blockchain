# 项目报告文档

1. [选题背景](#选题背景)
2. [使用说明](#使用说明)
3. [测试](#测试)

## 选题背景以及依据
- **选题背景**：  
学生的缴费参与的医保问题，如果我们是在校医处直接诊断开药，则会直接减去医保赔付的比例，十分方便。而当我们需要转诊外院的时候，需要到指定医院先自费进行治疗。而之后的医保理赔，需要等到治疗结束，并准备齐全医保条例上的各种资料，自行办理报销，而且报销周期长达一个月，十分麻烦。由此想到区块链智能合约的特性可以很好地应用于医疗保险方面。

 - **选题构思**：  
现在医疗保险的理赔流程大多都是先行垫付，之后再带病历资料申请理赔的。整个过程繁琐复杂，大大增加了被保人的负担，而且医疗保障系统的运行效率也比较低。而使用区块链智能合约技术能很好地改善这个问题，不仅提高了医疗保障系统的运作效率，也使得医保数据更加透明、公平和可信。
我们可以在医院、医保机构和医保人之间建区块链智能合约，根据医院提供的诊断、治疗费用等信息，医保机构可以自动判断分析数据，如果触发了预先写在智能合约中的理赔条件，则自动执行理赔操作，自动从医保账号中按相应的比例转账到患者的账户中。

## 使用说明
1. 使用环境  
Truffle v5.0.0 (core: 5.0.0)  
Solidity v0.5.0 (solc-js)  
Node v10.14.2
Geth v1.8.20

2. 下载Geth执行程序在主目录下，用genesis.json创建创世区块。

3. 修改start.bat文件中的数据目录为你的创世区块目录，然后执行start.bat，启动区块链本地节点。

4. 智能合约已经编译完成，只需要在truffle/app/中npm install安装所需依赖，然后执行node .\bin\www启动服务器。
5. 使用浏览器访问localhost:3000即可。  
**注意：安装完以来后如果提示找不到./build/Release/scrypt模块，需要到依赖目录node_modules中将index.js中require(./build/Release/scrypt)改为require(scrypt)**

## 测试
**涉及修改合约信息的都需要挖矿才能完成，请自行设置挖矿速率**
1. 注册账号  
直接输入密码返回生成的账号地址，这里注册了三个账号分别作为保险机构，医院与参保个人。
2. 登录账号  
登录第一个账号作为保险机构,顶部显示账号与账余额信息
3. 建立保险合同  
保险机构建立保险合同，输入保险费用以及赔付比例发起请求，挖矿后成功部署合同并返回智能合约的地址。
4. 查看/修改合同相关信息  
所有账号都可以查看合同信息，但只有合约建立者能修改合同信息。  
查看与修改保险费用测试（赔付比例同理）
5. 医院加入合约  
登录第二个账号作为医院机构，加入以上建立的的保险合约
6. 个人参保  
登录第三个账号作为参保个人，支付保险费用后加入保险合约
7. 医院开出账单  
医院在参保条约中开给个人医疗费用的账单。
8. 个人查询账单  
个人在参保条约中查询对应医院的医疗账单。
9. 个人支付费用  
通过调用合约的支付医疗费用时，保险合约自动审核把资金转到相应医院的账号并从合约的资金池中返还相应比例给个人。